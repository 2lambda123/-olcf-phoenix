#!/usr/bin/env python
"""Phoenix configuration"""
# vim: tabstop=4 shiftwidth=4 softtabstop=4

import sys
import argparse
import logging
from ClusterShell.NodeSet import NodeSet
import phoenix
from phoenix.Node import Node
from phoenix.System import System

def get_parser():
	parser = argparse.ArgumentParser(prog="phoenix_conf", description="Phoenix configuration utility")
	parser.add_argument('-v', '--verbose', action='count', default=0)
	subparsers = parser.add_subparsers(help='sub-command help')
	parser_hosts = subparsers.add_parser('hosts', help='hosts help')

	parser_dhcp = subparsers.add_parser('dhcp', help='dhcp help')

	#parser.add_argument("function", choices=['hosts', 'dhcp'])
	return parser

if __name__ == '__main__':
	parser = get_parser()
	args = parser.parse_args()

	phoenix.setup_logging(args.verbose)
	Node.load_nodes()

	for nodename,node in sorted(Node.nodes.items()):
		if 'interfaces' in node:
			for ifacename, iface in node['interfaces'].items():
				hostname = iface['hostname'] if 'hostname' in iface else nodename
				print "%s\t%s\t%s.%s" % (iface['ip'], hostname, hostname, System.config['domain'])
			#print node['name']

	rc = 0


	sys.exit(rc)
