#!/usr/bin/env python
"""Phoenix node info"""
# vim: tabstop=4 expandtab shiftwidth=4 softtabstop=4

import sys
import argparse
import logging
from ClusterShell.NodeSet import NodeSet
import Phoenix
from Phoenix.Node import Node

def get_parser():
    parser = argparse.ArgumentParser(prog="phoenix_node", description="List info about Phoenix nodes")
    parser.add_argument('nodes', nargs='+', default=None, type=str, help='Nodes to list')
    parser.add_argument('-v', '--verbose', action='count', default=0)
    return parser

if __name__ == '__main__':
    parser = get_parser()
    args = parser.parse_args()

    Phoenix.setup_logging(args.verbose)

    mynodes = NodeSet.fromlist(args.nodes)
    Node.load_nodes(nodeset=mynodes)

    rc = 0

    for node in mynodes:
        try:
            print Node.find_node(node)
        except KeyError:
            logging.error("Could not find node '%s'", node)
            rc = rc + 1

    sys.exit(rc)
